<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×—×™×“×•×Ÿ ×—×œ×œ - × ×§×•×“×•×ª ×‘×¢× ×Ÿ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Arial', sans-serif;
            background: #0a0e27;
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 800px; margin: 0 auto; }
        .header { text-align: center; padding: 20px; background: rgba(0,0,0,0.7); border-radius: 15px; margin-bottom: 20px; border: 2px solid #4fc3f7; }
        h1 { color: #4fc3f7; margin-bottom: 10px; }
        .screen { display: none; background: rgba(0,0,0,0.7); padding: 20px; border-radius: 15px; margin-bottom: 20px; }
        .active { display: block; }
        .btn { padding: 12px 24px; margin: 10px; background: #4fc3f7; color: black; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; display: inline-block; }
        .btn-red { background: #f44336; color: white; }
        input, select { padding: 12px; margin: 10px; width: 90%; max-width: 300px; border-radius: 8px; border: 2px solid #4fc3f7; background: #111; color: white; text-align: center; }
        .quiz-box { background: rgba(30,30,60,0.8); padding: 20px; border-radius: 10px; margin: 15px 0; border: 1px solid #4fc3f7; }
        .question { font-size: 1.2rem; margin-bottom: 20px; line-height: 1.5; }
        .answers { display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 15px; }
        .answer-btn { padding: 15px; background: #1a237e; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; }
        .answer-btn:hover { background: #283593; }
        .answer-btn.correct { background: #2E7D32; }
        .answer-btn.wrong { background: #C62828; }
        .scoreboard { background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px; margin: 20px 0; border: 2px solid #ffca28; }
        .score-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; margin-top: 15px; }
        .score-item { background: rgba(30,30,60,0.8); padding: 10px; border-radius: 8px; text-align: center; border: 1px solid #4fc3f7; transition: all 0.3s; }
        .highlight { background: rgba(255, 202, 40, 0.3); border: 2px solid #ffca28; }
        .progress { margin: 20px 0; text-align: center; color: #ffca28; font-size: 1.1rem; }
        .feedback { padding: 15px; border-radius: 8px; margin: 15px 0; text-align: center; font-weight: bold; display: none; }
        .correct-feedback { background: rgba(76, 175, 80, 0.2); border: 2px solid #4CAF50; color: #4CAF50; }
        .wrong-feedback { background: rgba(244, 67, 54, 0.2); border: 2px solid #f44336; color: #f44336; }
        .status { padding: 10px; border-radius: 5px; margin: 10px; text-align: center; font-weight: bold; background: rgba(0,0,0,0.5); }
        .online { background: rgba(76, 175, 80, 0.2); color: #4CAF50; border: 1px solid #4CAF50; }
        .offline { background: rgba(244, 67, 54, 0.2); color: #f44336; border: 1px solid #f44336; }
        @media (max-width: 768px) {
            .score-grid { grid-template-columns: repeat(3, 1fr); }
            .btn { display: block; width: 90%; margin: 10px auto; }
        }
    </style>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>
<div class="container">

    <!-- ×¡×˜×˜×•×¡ ×—×™×‘×•×¨ -->
    <div id="status" class="status offline">ğŸ”„ ××ª×—×‘×¨ ×œ×¢× ×Ÿ...</div>

    <!-- ××¡×š ×”×ª×—×‘×¨×•×ª -->
    <div class="screen active" id="loginScreen">
        <div class="header">
            <h1>ğŸš€ ×—×™×“×•×Ÿ ×—×œ×œ - × ×§×•×“×•×ª ×‘×¢× ×Ÿ</h1>
            <p>×›×•×œ× ×¨×•××™× ××ª ×”× ×§×•×“×•×ª ×‘×–××Ÿ ×××ª!</p>
        </div>
        <div style="text-align: center;">
            <input type="text" id="userName" placeholder="×©××š ×”××œ×">
            <select id="userClass">
                <option value="">×‘×—×¨ ×›×™×ª×”</option>
                <option value="×–1">×–1</option><option value="×–2">×–2</option>
                <option value="×–3">×–3</option><option value="×–4">×–4</option>
                <option value="×–5">×–5</option><option value="×–6">×–6</option>
                <option value="×–7">×–7</option><option value="×—1">×—1</option>
                <option value="×—2">×—2</option><option value="×—3">×—3</option>
                <option value="×—4">×—4</option><option value="×—5">×—5</option>
                <option value="×—6">×—6</option><option value="×˜1">×˜1</option>
                <option value="×˜2">×˜2</option><option value="×˜3">×˜3</option>
                <option value="×˜4">×˜4</option><option value="×˜5">×˜5</option>
                <option value="×˜6">×˜6</option>
            </select>
            <br>
            <button class="btn" onclick="login()">×”×ª×—×œ ×—×™×“×•×Ÿ</button>
        </div>
    </div>

    <!-- ××¡×š ×—×™×“×•×Ÿ -->
    <div class="screen" id="quizScreen">
        <div class="header">
            <h2 id="welcomeText"></h2>
            <p id="classInfo"></p>
        </div>
        <div class="progress">
            ×©××œ×” <span id="currentQuestionNum">1</span> ××ª×•×š 50
        </div>
        <div class="quiz-box">
            <div class="question" id="questionText"></div>
            <div class="answers" id="answers"></div>
        </div>
        <div class="feedback" id="feedback"></div>
        <div style="text-align: center;">
            <button class="btn" id="nextBtn" onclick="nextQuestion()" style="display:none;">×©××œ×” ×”×‘××”</button>
        </div>
        <div class="scoreboard">
            <h3 style="text-align: center; color: #ffca28;">ğŸ† ×œ×•×— × ×™×§×•×“ ××©×•×ª×£</h3>
            <div class="score-grid" id="scoreboard"></div>
        </div>
        <div style="text-align: center; margin-top: 20px;">
            <button class="btn btn-red" onclick="logout()">×™×¦×™××”</button>
        </div>
    </div>
</div>

<script>
    // ===== Firebase Config =====
    const firebaseConfig = {
        apiKey: "AIzaSyDpq2jXjY-QTfc_N5S4sqLs-NaRS7ow1vQ",
        authDomain: "space-school-72807.firebaseapp.com",
        databaseURL: "https://space-school-72807-default-rtdb.firebaseio.com",
        projectId: "space-school-72807",
        storageBucket: "space-school-72807.firebasestorage.app",
        messagingSenderId: "919939980128",
        appId: "1:919939980128:web:53c7b02240b9ac8347dc05"
    };

    // ===== Variables =====
    const classes = ["×–1","×–2","×–3","×–4","×–5","×–6","×–7","×—1","×—2","×—3","×—4","×—5","×—6","×˜1","×˜2","×˜3","×˜4","×˜5","×˜6"];
    let currentUser = null;
    let currentQuestionIndex = 0;
    let answeredCorrectly = 0;
    let totalQuestions = 50;
    let points = {};
    let db = null;
    let pointsRef = null;

    // ===== Quiz Questions =====
    const questions = [ /* same 50 questions as before */ ];

    // ===== Firebase Functions =====
    function initFirebase() {
        firebase.initializeApp(firebaseConfig);
        db = firebase.database();

        const connectedRef = db.ref('.info/connected');
        connectedRef.on('value', (snap) => {
            const connected = snap.val() === true;
            updateStatus(connected);

            if (connected) {
                pointsRef = db.ref('points');
                pointsRef.on('value', snapshot => {
                    const data = snapshot.val() || {};
                    classes.forEach(cls => points[cls] = data[cls] || 0);
                    updateScoreboard();
                    updateUserInfo();
                });
            }
        });
    }

    function saveToCloud() {
        if(pointsRef) pointsRef.set(points);
    }

    function updateStatus(connected) {
        const statusEl = document.getElementById('status');
        if(connected) { statusEl.textContent = "âœ… ××—×•×‘×¨ ×œ×¢× ×Ÿ - × ×§×•×“×•×ª ××©×•×ª×¤×•×ª"; statusEl.className = "status online"; }
        else { statusEl.textContent = "âš ï¸ ××¦×‘ ××§×œ×™ - × ×§×•×“×•×ª × ×©××¨×•×ª ×‘××—×©×‘ ×–×” ×‘×œ×‘×“"; statusEl.className = "status offline"; }
    }

    // ===== User Functions =====
    function login() {
        const name = document.getElementById('userName').value.trim();
        const className = document.getElementById('userClass').value;
        if(!name || !className) { alert("×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª"); return; }
        currentUser = { name, class: className };
        document.getElementById('welcomeText').textContent = `×©×œ×•× ${name}!`;
        document.getElementById('classInfo').textContent = `×›×™×ª×” ${className}`;
        showScreen('quizScreen');
        showQuestion();
        updateScoreboard();
    }

    function showQuestion() {
        if(currentQuestionIndex >= questions.length) { endQuiz(); return; }
        const q = questions[currentQuestionIndex];
        document.getElementById('questionText').textContent = q.question;
        document.getElementById('currentQuestionNum').textContent = currentQuestionIndex + 1;
        const answersDiv = document.getElementById('answers');
        answersDiv.innerHTML = '';
        q.answers.forEach((answer,i)=>{
            const btn=document.createElement('button'); btn.className='answer-btn'; btn.textContent=answer;
            btn.onclick=()=>checkAnswer(i); answersDiv.appendChild(btn);
        });
        document.getElementById('feedback').style.display='none';
        document.getElementById('nextBtn').style.display='none';
    }

    function checkAnswer(answerIndex){
        const q = questions[currentQuestionIndex];
        const feedback = document.getElementById('feedback');
        document.querySelectorAll('.answer-btn').forEach(btn=>btn.disabled=true);
        if(answerIndex===q.correct){
            feedback.textContent='ğŸ‰ ×ª×©×•×‘×” × ×›×•× ×”! +1 × ×§×•×“×” ×œ×›×™×ª×”!';
            feedback.className='feedback correct-feedback';
            points[currentUser.class]=(points[currentUser.class]||0)+1;
            answeredCorrectly++;
            saveToCloud();
            document.querySelectorAll('.answer-btn')[q.correct].classList.add('correct');
        } else {
            feedback.textContent=`âŒ ×œ× × ×›×•×Ÿ. ×”×ª×©×•×‘×” ×”× ×›×•× ×”: ${q.answers[q.correct]}`;
            feedback.className='feedback wrong-feedback';
            document.querySelectorAll('.answer-btn')[answerIndex].classList.add('wrong');
            document.querySelectorAll('.answer-btn')[q.correct].classList.add('correct');
        }
        feedback.style.display='block';
        document.getElementById('nextBtn').style.display='block';
        updateScoreboard();
    }

    function nextQuestion(){ currentQuestionIndex++; if(currentQuestionIndex<questions.length) showQuestion(); else endQuiz(); }

    function endQuiz(){
        const percentage=Math.round((answeredCorrectly/totalQuestions)*100);
        alert(`ğŸŠ ×¡×™×™××ª ××ª ×”×—×™×“×•×Ÿ!\n\nâœ… ${answeredCorrectly} ××ª×•×š ${totalQuestions} × ×›×•× ×•×ª\nğŸ“Š ${percentage}% ×”×¦×œ×—×”\nğŸ† ×›×™×ª×” ${currentUser.class}: ${points[currentUser.class] || 0} × ×§×•×“×•×ª`);
        currentQuestionIndex=0; answeredCorrectly=0; showQuestion();
    }

    function updateScoreboard(){
        const board = document.getElementById('scoreboard');
        board.innerHTML='';
        classes.forEach(cls=>{
            const item=document.createElement('div'); item.className='score-item';
            if(cls===currentUser?.class) item.classList.add('highlight');
            item.innerHTML=`<div style="font-weight:bold; color:#ffca28;">${cls}</div>
            <div style="font-size:1.5rem; color:#4fc3f7; font-weight:bold;">${points[cls]||0}</div>`;
            board.appendChild(item);
        });
    }

    function updateUserInfo(){ if(currentUser) document.getElementById('classInfo').textContent=`×›×™×ª×” ${currentUser.class}: ${points[currentUser.class]||0} × ×§×•×“×•×ª`; }

    function showScreen(id){ document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active')); document.getElementById(id).classList.add('active'); }

    function logout(){ if(confirm('×œ×¦××ª ××”××¢×¨×›×ª?')){ currentUser=null; currentQuestionIndex=0; answeredCorrectly=0; showScreen('loginScreen'); document.getElementById('userName').value=''; document.getElementById('userClass').value=''; } }

    // ===== Init =====
    function init(){ initFirebase(); classes.forEach(c=>points[c]=0); updateScoreboard(); }
    window.onload=init;

</script>
</body>
</html>
